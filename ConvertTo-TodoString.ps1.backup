<# .SYNOPSIS    Converts a todo object into a todo string.
.DESCRIPTION    Converts a todo object into a todo string.
.NOTES 
    Author		: Paul Broadwith (paul@pauby.com)
	History		: 1.0 - 23/09/15 - Initial version
.LINK 
    http://www.github.com/pauby
.PARAMETER Object    Todo object to convert.
.PARAMETER DoneDate    Specific days (numbered) to highlight. Used for date ranges like (25..31).    Date ranges are specified by the Windows PowerShell range syntax. These dates are    enclosed in square brackets.
.INPUTS
	Documentary text, eg: 
	Input type  [Universal.SolarSystem.Planetary.CommonSense] 
	Appears in -full 
.OUTPUTS
	Documentary Text, eg: 
	Output type  [Universal.SolarSystem.Planetary.Wisdom] 
	Appears in -full 
.EXAMPLE    Show-Calendar
		
	Show a default display of this month.
.EXAMPLE    Show-Calendar -Start "March, 2010" -End "May, 2010"

	Display a date range
#>

function ConvertTo-TodoString
{
    [CmdletBinding()]
    Param (
        [Parameter(Mandatory, ParameterSetName="Object")]
        [object]$Object,

        [Parameter(ParameterSetName="SeparateParams")]
        [string]$DoneDate,
    
        [Parameter(ParameterSetName="SeparateParams")]
        [string]$CreatedDate = (Get-Date -Format "yyyy-MM-dd"),

        [Parameter(ParameterSetName="SeparateParams")]
        [string]$Priority,

        [Parameter(Mandatory, ParameterSetName="SeparateParams")]
        [ValidateNotNullOrEmpty()]
        [string]$Task,

        [Parameter(ParameterSetName="SeparateParams")]
        [string[]]$Context,

        [Parameter(ParameterSetName="SeparateParams")]
        [string[]]$Project,

        [Parameter(ParameterSetName="SeparateParams")]
        [string]$DueDate,

        [Parameter(ParameterSetName="SeparateParams")]
        [string[]]$Addon    
    )

    $format = "{0}{1}{2} {3}{4}{5}{6}{7}" 
    
    if ($Object)
    {
        $format -f
            $( if ($Object.DoneDate -ne "") { "x $($Object.DoneDate) " } ), 
            $( if ($Object.Priority -ne "") { "($($Object.Priority)) " } ),
            $Object.CreatedDate,
            $Object.Task,
            $( if ($Object.Context -ne "") { " @$($Object.Context -join " @")" } ),
            $( if ($Object.Project -ne "") { " +$($Object.Project -join " +")" } ),
            $( if ($Object.DueDate -ne "") { " due:$($Object.DueDate)" } ),
            $( if ($Object.Addon -ne "") { " $($Object.Addon -join " ")" } )
    }
    else
    {
        $format -f
            $( if ($DoneDate -ne "") { "x $DoneDate " } ), 
            $( if ($Priority -ne "") { "($Priority) " } ),
            $CreatedDate,
            $Task,
            $( if ($Context -ne "") { " @$($Context -join " @")" } ),
            $( if ($Project -ne "") { " +$($Project -join " +")" } ),
            $( if ($DueDate -ne "") { " due:$DueDate" } ),
            $( if ($Addon -ne "") { " $($Addon -join " ")" } )
    }   
}
         